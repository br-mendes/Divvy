"use strict";(()=>{var e={};e.id=8508,e.ids=[8508,660],e.modules={11270:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>b,default:()=>m,getServerSideProps:()=>u,getStaticPaths:()=>p,getStaticProps:()=>h,reportWebVitals:()=>y,routeModule:()=>N,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>k});var s=a(87093),d=a(35244),l=a(1323),i=a(61682),n=a.n(i),o=a(48141),c=a.n(o),x=a(54157),g=e([x]);x=(g.then?(await g)():g)[0];let m=(0,l.l)(x,"default"),h=(0,l.l)(x,"getStaticProps"),p=(0,l.l)(x,"getStaticPaths"),u=(0,l.l)(x,"getServerSideProps"),b=(0,l.l)(x,"config"),y=(0,l.l)(x,"reportWebVitals"),k=(0,l.l)(x,"unstable_getStaticProps"),j=(0,l.l)(x,"unstable_getStaticPaths"),f=(0,l.l)(x,"unstable_getStaticParams"),v=(0,l.l)(x,"unstable_getServerProps"),w=(0,l.l)(x,"unstable_getServerSideProps"),N=new s.PagesRouteModule({definition:{kind:d.x.PAGES,page:"/admin.active",pathname:"/admin.active",bundlePath:"",filename:""},components:{App:c(),Document:n()},userland:x});t()}catch(e){t(e)}})},94279:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},31696:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]])},80906:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},13427:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},87211:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]])},11373:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},33656:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},60606:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]])},93012:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},53487:(e,r,a)=>{a.d(r,{Z:()=>t});let t=(0,a(1).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},54157:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{default:()=>P});var s=a(20997),d=a(16689),l=a(11163),i=a(54133),n=a(46159),o=a(9809),c=a(90747),x=a(77467),g=a(18836),m=a(86201),h=a(11373),p=a(74326),u=a(41138),b=a(56286),y=a(87211),k=a(93012),j=a(60606),f=a(94279),v=a(53487),w=a(28335),N=a(31696),S=a(14132),Z=a(80906),E=a(91560),z=a(33656),C=a(13427),q=a(72003),A=a(18742),L=e([o,m]);function P(){let{user:e,session:r,loading:a}=(0,n.a)();(0,l.useRouter)();let[t,L]=(0,d.useState)("overview"),[P,D]=(0,d.useState)(!1),[M,_]=(0,d.useState)(!0),[T,$]=(0,d.useState)(null),[G,F]=(0,d.useState)([]),[R,O]=(0,d.useState)([]),[V,B]=(0,d.useState)([]),[I,U]=(0,d.useState)([]),[H,J]=(0,d.useState)(!1),[W,X]=(0,d.useState)(""),[K,Q]=(0,d.useState)(""),[Y,ee]=(0,d.useState)(!1),[er,ea]=(0,d.useState)(""),[et,es]=(0,d.useState)(""),[ed,el]=(0,d.useState)(""),[ei,en]=(0,d.useState)("all"),[eo,ec]=(0,d.useState)(""),[ex,eg]=(0,d.useState)(""),[em,eh]=(0,d.useState)(!1),ep=(0,d.useCallback)(()=>({"Content-Type":"application/json",Authorization:`Bearer ${r?.access_token}`}),[r]),eu=(0,d.useCallback)(async e=>{if(r?.access_token){J(!0);try{if("overview"===e){let e=await fetch("/api/admin/stats",{headers:ep()});if(!e.ok)throw Error((await e.json()).error||"Falha ao carregar estat\xedsticas");$(await e.json())}else if("users"===e){let e=await fetch("/api/admin/users",{headers:ep()});if(!e.ok)throw Error((await e.json()).error||"Falha ao carregar usu\xe1rios");F(await e.json())}else if("groups"===e){let e=await fetch("/api/admin/groups",{headers:ep()});if(!e.ok)throw Error((await e.json()).error||"Falha ao carregar grupos");O(await e.json())}else if("tickets"===e){let{data:e,error:r}=await i.O.from("supporttickets").select("*").order("createdat",{ascending:!1});if(r)throw r;B(e||[])}else if("broadcast"===e){let e=await fetch("/api/admin/broadcasts/list",{headers:ep()});if(!e.ok)throw Error((await e.json()).error||"Falha ao carregar mensagens");U(await e.json())}}catch(e){console.error(e),m.default.error(e.message||"Erro ao carregar dados")}finally{J(!1)}}},[r,ep]),eb=async e=>{e.preventDefault(),eh(!0);try{let e={title:er,body:et,target:ei,starts_at:eo||new Date().toISOString(),ends_at:ex||null},r=await fetch("/api/admin/broadcast",{method:"POST",headers:ep(),body:JSON.stringify(e)});if(!r.ok){let e=await r.json();throw Error(e.error||"Erro ao enviar broadcast")}m.default.success("Mensagem programada/enviada com sucesso!"),ee(!1),ea(""),es(""),el(""),ec(""),eg(""),eu("broadcast")}catch(e){m.default.error("Erro: "+e.message)}finally{eh(!1)}},ey=async e=>{if(confirm("Tem certeza que deseja excluir esta mensagem? Ela deixar\xe1 de aparecer para todos os usu\xe1rios imediatamente."))try{if(!(await fetch(`/api/admin/broadcasts/${e}`,{method:"DELETE",headers:ep()})).ok)throw Error("Erro ao excluir");m.default.success("Mensagem exclu\xedda."),U(I.filter(r=>r.id!==e))}catch(e){m.default.error(e.message)}},ek=async e=>{if(confirm("Marcar este ticket como resolvido e excluir?"))try{if(!(await fetch(`/api/admin/tickets/${e}`,{method:"DELETE",headers:ep()})).ok)throw Error("Falha ao resolver");m.default.success("Ticket resolvido"),B(V.filter(r=>r.id!==e))}catch(e){m.default.error(e.message)}},ej=async(e,r)=>{let a="suspended"===r?"active":"suspended";if(confirm(`Tem certeza que deseja ${"active"===a?"Reativar":"Suspender"} este usu\xe1rio?`))try{if(!(await fetch(`/api/admin/users/${e}/status`,{method:"POST",headers:ep(),body:JSON.stringify({status:a})})).ok)throw Error("Falha ao alterar status");F(G.map(r=>r.id===e?{...r,status:a}:r)),m.default.success(`Usu\xe1rio ${"active"===a?"reativado":"suspenso"}.`)}catch(e){m.default.error(e.message)}},ef=async e=>{let r=prompt("Para confirmar a exclus\xe3o deste grupo, digite 'DELETAR':");if("DELETAR"===r)try{if(!(await fetch("/api/admin/groups",{method:"DELETE",headers:ep(),body:JSON.stringify({id:e})})).ok)throw Error("Falha ao deletar grupo");O(R.filter(r=>r.id!==e)),m.default.success("Grupo exclu\xeddo.")}catch(e){m.default.error(e.message)}},ev=G.filter(e=>(e.email||"").toLowerCase().includes(W.toLowerCase())||(e.fullname||"").toLowerCase().includes(W.toLowerCase())),ew=R.filter(e=>(e.name||"").toLowerCase().includes(K.toLowerCase())),eN=e=>{let r=new Date,a=new Date(e.starts_at?e.starts_at:e.createdat),t=e.ends_at?new Date(e.ends_at):null;return t&&r>t?{label:"Expirado",color:"bg-red-100 text-red-700"}:r<a?{label:"Agendado",color:"bg-yellow-100 text-yellow-700"}:{label:"Ativo",color:"bg-green-100 text-green-700"}};return a||M?(0,s.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-dark-950 text-gray-500 gap-4",children:[s.jsx(h.Z,{className:"animate-spin text-brand-600",size:40}),s.jsx("p",{children:"Verificando permiss\xf5es administrativas..."})]}):P?s.jsx(g.i,{children:s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-950 pb-20",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"bg-brand-600 p-3 rounded-xl shadow-lg shadow-brand-500/30",children:s.jsx(p.Z,{size:32,className:"text-white"})}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Painel Administrativo"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Controle total do sistema Divvy"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm bg-white dark:bg-dark-900 py-2 px-4 rounded-full border border-gray-200 dark:border-dark-800 shadow-sm text-green-600 dark:text-green-400",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"Admin Conectado: ",e?.email]})]}),s.jsx("div",{className:"flex overflow-x-auto gap-2 mb-8 pb-2 scrollbar-hide border-b border-gray-200 dark:border-dark-800",children:[{id:"overview",label:"Vis\xe3o Geral",icon:u.Z},{id:"users",label:"Usu\xe1rios",icon:b.Z},{id:"groups",label:"Grupos",icon:y.Z},{id:"tickets",label:"Tickets",icon:k.Z,count:V.length},{id:"broadcast",label:"Broadcast",icon:j.Z}].map(e=>(0,s.jsxs)("button",{onClick:()=>L(e.id),className:`flex items-center gap-2 px-6 py-3 rounded-t-lg font-medium transition-all whitespace-nowrap ${t===e.id?"bg-white dark:bg-dark-900 text-brand-600 border-b-2 border-brand-600":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[s.jsx(e.icon,{size:18}),e.label,e.count?s.jsx("span",{className:"ml-1 bg-red-500 text-white text-[10px] px-1.5 rounded-full",children:e.count}):null]},e.id))}),(0,s.jsxs)("div",{className:"animate-fade-in-up",children:["overview"===t&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 flex items-center justify-between relative overflow-hidden group",children:[(0,s.jsxs)("div",{className:"relative z-10",children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-bold uppercase tracking-wider",children:"Usu\xe1rios Totais"}),s.jsx("p",{className:"text-4xl font-black text-gray-900 dark:text-white mt-2",children:H?"...":T?.totalUsers||0})]}),s.jsx("div",{className:"w-16 h-16 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform",children:s.jsx(b.Z,{size:32})})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 flex items-center justify-between group",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-bold uppercase tracking-wider",children:"Grupos Totais"}),s.jsx("p",{className:"text-4xl font-black text-gray-900 dark:text-white mt-2",children:H?"...":T?.totalDivvies||0})]}),s.jsx("div",{className:"w-16 h-16 bg-purple-50 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform",children:s.jsx(f.Z,{size:32})})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 flex items-center justify-between group",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-bold uppercase tracking-wider",children:"Grupos Ativos"}),s.jsx("p",{className:"text-4xl font-black text-green-600 dark:text-green-400 mt-2",children:H?"...":T?.activeGroups||0})]}),s.jsx("div",{className:"w-16 h-16 bg-green-50 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform",children:s.jsx(f.Z,{size:32})})]})]}),"users"===t&&(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-100 dark:border-dark-800 flex flex-col sm:flex-row justify-between items-center gap-4",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Gerenciar Usu\xe1rios"}),(0,s.jsxs)("div",{className:"relative w-full sm:w-64",children:[s.jsx(v.Z,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar por nome ou email...",value:W,onChange:e=>X(e.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 dark:border-dark-700 bg-gray-50 dark:bg-dark-800 text-sm focus:outline-none focus:ring-2 focus:ring-brand-500"})]})]}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[s.jsx("thead",{className:"bg-gray-50 dark:bg-dark-800 text-gray-500 dark:text-gray-400 font-medium",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-4",children:"Usu\xe1rio"}),s.jsx("th",{className:"px-6 py-4",children:"Email"}),s.jsx("th",{className:"px-6 py-4",children:"Cadastro"}),s.jsx("th",{className:"px-6 py-4",children:"Status"}),s.jsx("th",{className:"px-6 py-4 text-center",children:"A\xe7\xf5es"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-dark-800",children:H?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"Carregando usu\xe1rios..."})}):0===ev.length?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum usu\xe1rio encontrado."})}):ev.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-dark-800/50 transition-colors",children:[(0,s.jsxs)("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-white flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-100 dark:bg-brand-900/30 flex items-center justify-center text-brand-600 dark:text-brand-400 font-bold shrink-0",children:e.fullname?.charAt(0)||e.email.charAt(0)}),(0,s.jsxs)("div",{children:[s.jsx("div",{children:e.fullname||"Sem nome"}),s.jsx("div",{className:"text-xs text-gray-400",children:e.id})]})]}),s.jsx("td",{className:"px-6 py-4 text-gray-600 dark:text-gray-300",children:e.email}),s.jsx("td",{className:"px-6 py-4 text-gray-500",children:new Date(e.createdat).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"suspended"===e.status?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"}`,children:"suspended"===e.status?"Suspenso":"Ativo"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{onClick:()=>ej(e.id,e.status||"active"),className:`p-2 rounded-lg transition-colors ${"suspended"===e.status?"text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20":"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"}`,title:"suspended"===e.status?"Reativar usu\xe1rio":"Suspender usu\xe1rio",children:"suspended"===e.status?s.jsx(w.Z,{size:18}):s.jsx(N.Z,{size:18})})})]},e.id))})]})})]}),"groups"===t&&(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-100 dark:border-dark-800 flex flex-col sm:flex-row justify-between items-center gap-4",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Gerenciar Grupos"}),(0,s.jsxs)("div",{className:"relative w-full sm:w-64",children:[s.jsx(v.Z,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar grupos...",value:K,onChange:e=>Q(e.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 dark:border-dark-700 bg-gray-50 dark:bg-dark-800 text-sm focus:outline-none focus:ring-2 focus:ring-brand-500"})]})]}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[s.jsx("thead",{className:"bg-gray-50 dark:bg-dark-800 text-gray-500 dark:text-gray-400 font-medium",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-4",children:"Nome"}),s.jsx("th",{className:"px-6 py-4",children:"Tipo"}),s.jsx("th",{className:"px-6 py-4 text-center",children:"Membros"}),s.jsx("th",{className:"px-6 py-4",children:"Status"}),s.jsx("th",{className:"px-6 py-4 text-center",children:"A\xe7\xf5es"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-dark-800",children:H?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"Carregando grupos..."})}):0===ew.length?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum grupo encontrado."})}):ew.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-dark-800/50 transition-colors",children:[(0,s.jsxs)("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-white",children:[e.name,s.jsx("div",{className:"text-xs text-gray-400",children:e.id})]}),s.jsx("td",{className:"px-6 py-4 capitalize text-gray-600 dark:text-gray-300",children:e.type}),s.jsx("td",{className:"px-6 py-4 text-center text-gray-600 dark:text-gray-300 font-mono",children:e.member_count}),s.jsx("td",{className:"px-6 py-4",children:e.isarchived?(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs text-gray-500 bg-gray-100 dark:bg-dark-700 px-2 py-0.5 rounded",children:[s.jsx(S.Z,{size:10})," Arquivado"]}):(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs text-green-600 bg-green-100 dark:bg-green-900/20 px-2 py-0.5 rounded",children:[s.jsx(Z.Z,{size:10})," Ativo"]})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{onClick:()=>ef(e.id),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Excluir Grupo",children:s.jsx(E.Z,{size:18})})})]},e.id))})]})})]}),"tickets"===t&&(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 p-6",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6",children:"Tickets de Suporte"}),s.jsx("div",{className:"grid gap-4",children:H?s.jsx("p",{className:"text-gray-500 text-center py-10",children:"Carregando tickets..."}):0===V.length?(0,s.jsxs)("div",{className:"text-center py-16 bg-gray-50 dark:bg-dark-800 rounded-xl border border-dashed border-gray-200 dark:border-dark-700",children:[s.jsx(w.Z,{size:48,className:"mx-auto text-green-500 mb-4"}),s.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:"Tudo limpo!"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Nenhum ticket pendente."})]}):V.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-800 p-5 rounded-xl border border-gray-200 dark:border-dark-700 hover:shadow-md transition-all",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-bold text-gray-900 dark:text-white text-lg",children:e.subject}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-1",children:[s.jsx("span",{className:"bg-gray-100 dark:bg-dark-700 px-2 py-0.5 rounded text-xs font-mono",children:new Date(e.createdat).toLocaleString()}),s.jsx("span",{children:"•"}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[s.jsx(z.Z,{size:12})," ",e.email]}),e.name&&(0,s.jsxs)("span",{children:["• ",e.name]})]})]}),(0,s.jsxs)("button",{onClick:()=>ek(e.id),className:"p-2 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-colors flex items-center gap-2 text-sm font-medium border border-transparent hover:border-green-200",title:"Marcar como resolvido",children:[s.jsx(w.Z,{size:18})," Resolver"]})]}),s.jsx("div",{className:"bg-gray-50 dark:bg-dark-900 p-4 rounded-lg text-gray-700 dark:text-gray-300 text-sm leading-relaxed border border-gray-100 dark:border-dark-700",children:e.message}),s.jsx("div",{className:"mt-3 flex justify-end",children:(0,s.jsxs)("a",{href:`mailto:${e.email}?subject=Re: ${e.subject}&body=%0A%0AEm resposta a: "${e.message.substring(0,50)}..."`,className:"text-brand-600 hover:text-brand-700 dark:text-brand-400 text-sm font-bold flex items-center gap-1",children:[s.jsx(C.Z,{size:14})," Responder por Email"]})})]},e.id))})]}),"broadcast"===t&&(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 p-8 flex flex-col items-center text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 rounded-full flex items-center justify-center mb-6",children:s.jsx(j.Z,{size:40})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Enviar Mensagem Global"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 max-w-md mb-8",children:"Envie notifica\xe7\xf5es importantes para todos os usu\xe1rios do sistema. Voc\xea pode agendar o in\xedcio e o fim da exibi\xe7\xe3o."}),s.jsx(o.z,{size:"lg",onClick:()=>ee(!0),className:"px-8 shadow-xl shadow-brand-500/20",children:"Criar Nova Mensagem"})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-dark-900 rounded-2xl shadow-sm border border-gray-100 dark:border-dark-800 overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray-100 dark:border-dark-800",children:s.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:"Hist\xf3rico de Mensagens"})}),s.jsx("div",{className:"divide-y divide-gray-100 dark:divide-dark-800",children:H?s.jsx("p",{className:"p-8 text-center text-gray-500",children:"Carregando..."}):0===I.length?s.jsx("p",{className:"p-8 text-center text-gray-500",children:"Nenhuma mensagem enviada."}):I.map(e=>{let r=eN(e);return(0,s.jsxs)("div",{className:"p-6 flex flex-col md:flex-row justify-between items-start gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wider ${r.color}`,children:r.label}),s.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.createdat).toLocaleDateString()})]}),s.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white mb-1",children:e.title}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:e.body}),(0,s.jsxs)("div",{className:"flex gap-4 mt-3 text-xs text-gray-500 dark:text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[s.jsx(q.Z,{size:12}),"In\xedcio: ",e.starts_at?new Date(e.starts_at).toLocaleString():"Imediato"]}),e.ends_at&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[s.jsx(A.Z,{size:12}),"Fim: ",new Date(e.ends_at).toLocaleString()]})]})]}),s.jsx("button",{onClick:()=>ey(e.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Excluir Mensagem",children:s.jsx(E.Z,{size:18})})]},e.id)})})]})]})]}),s.jsx(x.u,{isOpen:Y,onClose:()=>ee(!1),title:"Enviar Broadcast",children:(0,s.jsxs)("form",{onSubmit:eb,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"P\xfablico Alvo"}),(0,s.jsxs)("select",{value:ei,onChange:e=>en(e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-dark-700 bg-white dark:bg-dark-800 px-3 py-2 text-gray-900 dark:text-white",children:[s.jsx("option",{value:"all",children:"Todos os usu\xe1rios"}),s.jsx("option",{value:"active",children:"Ativos (\xfaltimos 30 dias)"}),s.jsx("option",{value:"inactive30",children:"Inativos (+30 dias)"})]})]}),s.jsx(c.I,{label:"T\xedtulo da Mensagem",value:er,onChange:e=>ea(e.target.value),required:!0,placeholder:"Ex: Manuten\xe7\xe3o Programada"}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Conte\xfado"}),s.jsx("textarea",{value:et,onChange:e=>es(e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-dark-700 bg-white dark:bg-dark-800 px-3 py-2 h-32 text-gray-900 dark:text-white focus:ring-2 focus:ring-brand-500 focus:outline-none",required:!0,placeholder:"Digite sua mensagem aqui..."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 dark:bg-dark-800 p-3 rounded-lg border border-gray-200 dark:border-dark-700",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-500 uppercase",children:"Agendar In\xedcio"}),s.jsx("input",{type:"datetime-local",className:"w-full rounded border border-gray-300 dark:border-dark-600 bg-white dark:bg-dark-900 px-2 py-1 text-sm text-gray-900 dark:text-white",value:eo,onChange:e=>ec(e.target.value)}),s.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Deixe vazio para enviar agora."})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-500 uppercase",children:"Agendar Fim (Expira\xe7\xe3o)"}),s.jsx("input",{type:"datetime-local",className:"w-full rounded border border-gray-300 dark:border-dark-600 bg-white dark:bg-dark-900 px-2 py-1 text-sm text-gray-900 dark:text-white",value:ex,onChange:e=>eg(e.target.value)}),s.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Deixe vazio para n\xe3o expirar."})]})]}),s.jsx(o.z,{fullWidth:!0,type:"submit",isLoading:em,children:eo?"Agendar Mensagem":"Enviar Agora"})]})})]})})}):null}[o,m]=L.then?(await L)():L,t()}catch(e){t(e)}})},14001:e=>{e.exports=require("@supabase/auth-helpers-nextjs")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},16689:e=>{e.exports=require("react")},66405:e=>{e.exports=require("react-dom")},20997:e=>{e.exports=require("react/jsx-runtime")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},71568:e=>{e.exports=require("zlib")},16593:e=>{e.exports=import("clsx")},86201:e=>{e.exports=import("react-hot-toast")},68097:e=>{e.exports=import("tailwind-merge")}};var r=require("../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[1682,9239,1664,9332,1163,6733],()=>a(11270));module.exports=t})();