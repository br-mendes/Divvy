"use strict";(()=>{var e={};e.id=2981,e.ids=[2981,660],e.modules={94606:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{config:()=>b,default:()=>x,getServerSideProps:()=>m,getStaticPaths:()=>p,getStaticProps:()=>h,reportWebVitals:()=>v,routeModule:()=>N,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>f,unstable_getStaticProps:()=>y});var s=t(87093),n=t(35244),i=t(1323),l=t(61682),o=t.n(l),d=t(48141),c=t.n(d),u=t(87870),g=e([u]);u=(g.then?(await g)():g)[0];let x=(0,i.l)(u,"default"),h=(0,i.l)(u,"getStaticProps"),p=(0,i.l)(u,"getStaticPaths"),m=(0,i.l)(u,"getServerSideProps"),b=(0,i.l)(u,"config"),v=(0,i.l)(u,"reportWebVitals"),y=(0,i.l)(u,"unstable_getStaticProps"),f=(0,i.l)(u,"unstable_getStaticPaths"),j=(0,i.l)(u,"unstable_getStaticParams"),w=(0,i.l)(u,"unstable_getServerProps"),S=(0,i.l)(u,"unstable_getServerSideProps"),N=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/join/[token].page",pathname:"/join/[token].page",bundlePath:"",filename:""},components:{App:c(),Document:o()},userland:u});a()}catch(e){a(e)}})},9809:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.d(r,{z:()=>o});var s=t(20997);t(16689);var n=t(16593),i=t(68097),l=e([n,i]);[n,i]=l.then?(await l)():l;let o=({className:e,variant:r="primary",size:t="md",fullWidth:a=!1,isLoading:l=!1,children:o,disabled:d,...c})=>(0,s.jsxs)("button",{className:function(...e){return(0,i.twMerge)((0,n.clsx)(e))}("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none dark:focus:ring-offset-gray-900",{primary:"bg-brand-600 text-white hover:bg-brand-700 focus:ring-brand-500 dark:bg-brand-600 dark:hover:bg-brand-700",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",outline:"border border-gray-300 bg-transparent text-gray-700 hover:bg-gray-50 focus:ring-gray-500 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-800",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500 dark:text-gray-300 dark:hover:bg-gray-800",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 dark:bg-red-600 dark:hover:bg-red-700"}[r],{sm:"h-8 px-3 text-xs",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[t],a?"w-full":"",e),disabled:d||l,...c,children:[l&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o]});a()}catch(e){a(e)}})},69683:(e,r,t)=>{t.d(r,{Z:()=>s});var a=t(20997);function s(){return a.jsx("div",{className:"flex flex-col items-center justify-center gap-6",children:(0,a.jsxs)("div",{className:"relative w-20 h-20",children:[a.jsx("div",{className:"absolute inset-0 border-4 border-brand-500/10 rounded-full"}),a.jsx("div",{className:"absolute inset-0 border-4 border-t-brand-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"}),a.jsx("div",{className:"absolute inset-4 bg-brand-500/20 rounded-full animate-pulse"}),a.jsx("div",{className:"absolute inset-7 bg-brand-500 rounded-full shadow-[0_0_15px_rgba(139,92,246,0.8)]"})]})})}t(16689)},46159:(e,r,t)=>{t.d(r,{H:()=>o,a:()=>d});var a=t(20997),s=t(16689),n=t(54133),i=t(39332);let l=(0,s.createContext)({user:null,session:null,loading:!0,signOut:async()=>{}}),o=({children:e})=>{let[r,t]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0),g=(0,i.useRouter)();(0,s.useEffect)(()=>{n.O.auth.getSession().then(({data:{session:e}})=>{d(e),t(e?.user??null)}).catch(e=>{console.error("Auth session check failed",e)}).finally(()=>{u(!1)});let{data:{subscription:e}}=n.O.auth.onAuthStateChange((e,r)=>{d(r),t(r?.user??null),u(!1),"SIGNED_OUT"===e&&g.push("/")});return()=>e.unsubscribe()},[g]);let x=async()=>{try{await n.O.auth.signOut()}catch(e){console.error("Error signing out:",e)}finally{g.push("/")}};return a.jsx(l.Provider,{value:{user:r,session:o,loading:c,signOut:x},children:e})},d=()=>(0,s.useContext)(l)},54133:(e,r,t)=>{t.d(r,{O:()=>a});let a=(0,t(14001).createClientComponentClient)()},87870:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{default:()=>p});var s=t(20997),n=t(16689),i=t(11163),l=t(41664),o=t.n(l),d=t(54133),c=t(46159),u=t(9809),g=t(69683),x=t(86201),h=e([u,x]);function p(){let e=(0,i.useRouter)(),{token:r}=e.query,{user:t,loading:a}=(0,c.a)(),[l,h]=(0,n.useState)(!0),[p,m]=(0,n.useState)(!1),[b,v]=(0,n.useState)(null),[y,f]=(0,n.useState)(null),j=async()=>{if(t&&b){m(!0);try{let{data:a,error:s}=await d.O.rpc("accept_divvy_invite",{p_token:r,p_user_id:t.id,p_user_email:t.email});if(s)throw s;if(a)x.default.success(`Voc\xea entrou em ${b.divvy_name}!`),e.push(`/divvy/${b.divvy_id}`);else throw Error("N\xe3o foi poss\xedvel aceitar o convite. Ele pode ter expirado ou ser inv\xe1lido.")}catch(e){console.error(e),x.default.error(e.message||"Erro ao aceitar convite.")}finally{m(!1)}}};return l||a?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsx(g.Z,{})}):y?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md text-center",children:[s.jsx("div",{className:"text-4xl mb-4",children:"\uD83D\uDE15"}),s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Ops! Algo deu errado."}),s.jsx("p",{className:"text-gray-600 mb-6",children:y}),s.jsx(o(),{href:"/",children:s.jsx(u.z,{variant:"primary",children:"Ir para In\xedcio"})})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md text-center",children:[s.jsx("div",{className:"text-5xl mb-6",children:"\uD83D\uDCE9"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Convite para Divvy"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-6",children:["Voc\xea foi convidado por ",s.jsx("strong",{children:b?.inviter_name})," para participar do grupo de despesas ",s.jsx("strong",{children:b?.divvy_name}),"."]}),t?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Entrar como ",s.jsx("strong",{children:t.email})]}),s.jsx(u.z,{variant:"primary",fullWidth:!0,onClick:j,isLoading:p,children:"Aceitar Convite"}),s.jsx(o(),{href:"/dashboard",className:"block mt-2",children:s.jsx(u.z,{variant:"outline",fullWidth:!0,disabled:p,children:"Cancelar"})})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Fa\xe7a login ou crie uma conta para aceitar."}),s.jsx(o(),{href:`/auth/login?redirect=${encodeURIComponent(`/join/${r}`)}`,children:s.jsx(u.z,{variant:"primary",fullWidth:!0,children:"Fazer Login"})}),s.jsx(o(),{href:`/auth/signup?redirect=${encodeURIComponent(`/join/${r}`)}`,children:s.jsx(u.z,{variant:"outline",fullWidth:!0,children:"Criar Conta"})})]})]})})}[u,x]=h.then?(await h)():h,a()}catch(e){a(e)}})},14001:e=>{e.exports=require("@supabase/auth-helpers-nextjs")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},16689:e=>{e.exports=require("react")},66405:e=>{e.exports=require("react-dom")},20997:e=>{e.exports=require("react/jsx-runtime")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},71568:e=>{e.exports=require("zlib")},16593:e=>{e.exports=import("clsx")},86201:e=>{e.exports=import("react-hot-toast")},68097:e=>{e.exports=import("tailwind-merge")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1682,9239,1664,9332,1163],()=>t(94606));module.exports=a})();