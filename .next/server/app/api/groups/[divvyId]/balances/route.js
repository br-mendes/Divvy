"use strict";(()=>{var e={};e.id=3821,e.ids=[3821],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78092:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>_,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>v});var s={};t.r(s),t.d(s,{GET:()=>d});var a=t(49303),o=t(88716),i=t(60670),n=t(87070),u=t(30474);async function d(e,{params:r}){let{divvyId:t}=r;if(!t)return n.NextResponse.json({error:"ID do grupo obrigat\xf3rio"},{status:400});let{searchParams:s}=new URL(e.url),a=s.get("from"),o=s.get("to"),i=(0,u.f)(),{data:d,error:p}=await i.from("divvymembers").select("userid").eq("divvyid",t);if(p)return n.NextResponse.json({error:p.message},{status:500});let c=i.from("expenses").select("id, payeruserid, amount_cents, currency, expense_date").eq("divvyid",t);a&&(c=c.gte("expense_date",a)),o&&(c=c.lte("expense_date",o));let{data:v,error:l}=await c;if(l)return n.NextResponse.json({error:l.message},{status:500});let m=(v??[]).map(e=>e.id),_=[];if(m.length){let{data:e,error:r}=await i.from("expense_splits").select("expenseid, userid, amount_cents").eq("divvyid",t).in("expenseid",m);if(r)return n.NextResponse.json({error:r.message},{status:500});_=e??[]}let f=i.from("payments").select("from_userid, to_userid, amount_cents, paid_at").eq("divvyid",t);a&&(f=f.gte("paid_at",a)),o&&(f=f.lte("paid_at",o));let{data:g,error:x}=await f;if(x)return n.NextResponse.json({error:x.message},{status:500});let y={};return d?.forEach(e=>{y[e.userid]=0}),v?.forEach(e=>{void 0!==y[e.payeruserid]&&(y[e.payeruserid]+=e.amount_cents)}),_.forEach(e=>{void 0!==y[e.userid]&&(y[e.userid]-=e.amount_cents)}),g?.forEach(e=>{void 0!==y[e.from_userid]&&(y[e.from_userid]+=e.amount_cents),void 0!==y[e.to_userid]&&(y[e.to_userid]-=e.amount_cents)}),n.NextResponse.json({balances:y,payments:g??[]})}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/groups/[divvyId]/balances/route",pathname:"/api/groups/[divvyId]/balances",filename:"route",bundlePath:"app/api/groups/[divvyId]/balances/route"},resolvedPagePath:"C:\\Users\\bruno\\Documents\\GitHub\\Divvy\\app\\api\\groups\\[divvyId]\\balances\\route.ts",nextConfigOutput:"export",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:v,serverHooks:l}=p,m="/api/groups/[divvyId]/balances/route";function _(){return(0,i.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:v})}},30474:(e,r,t)=>{t.d(r,{f:()=>i});var s=t(37857);let a="https://jpgifiumxqzbroejhudc.supabase.co",o=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!a)throw Error("Missing env NEXT_PUBLIC_SUPABASE_URL");if(!o)throw Error("Missing env SUPABASE_SERVICE_ROLE_KEY");let i=()=>(0,s.eI)(a,o,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,7857],()=>t(78092));module.exports=s})();