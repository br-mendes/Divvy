"use strict";(()=>{var e={};e.id=6503,e.ids=[6503],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},37698:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>l,serverHooks:()=>c,staticGenerationAsyncStorage:()=>v});var a={};t.r(a),t.d(a,{GET:()=>p});var i=t(49303),s=t(88716),o=t(60670),d=t(87070),n=t(30474),u=t(78803);async function p(e){try{let r=await (0,u.m)(e),t=(0,n.f)(),{data:a,error:i}=await t.from("divvies").select("*").eq("creatorid",r.id);if(i)throw i;let{data:s,error:o}=await t.from("divvymembers").select("divvyid").eq("userid",r.id);if(o)throw o;let p=(s||[]).map(e=>e.divvyid),l=[];if(p.length>0){let{data:e,error:r}=await t.from("divvies").select("*").in("id",p);if(r)throw r;l=e||[]}let h=[...a||[],...l],v=new Map;h.forEach(e=>v.set(e.id,e));let c=Array.from(v.values()),m=c.map(e=>e.id),f={};if(m.length>0){let{data:e,error:r}=await t.from("divvymembers").select(`
          *,
          userprofiles (
            id, fullname, displayname, avatarurl
          )
        `).in("divvyid",m);if(r)throw r;(e||[]).forEach(e=>{f[e.divvyid]||(f[e.divvyid]=[]);let r=Array.isArray(e.userprofiles)?e.userprofiles[0]:e.userprofiles;f[e.divvyid].push({...e,userprofiles:r})})}let E=c.map(e=>{let r=f[e.id]||[];return{...e,members:r,member_count:Math.max(r.length,1)}});return E.sort((e,r)=>new Date(r.createdat).getTime()-new Date(e.createdat).getTime()),d.NextResponse.json(E,{status:200})}catch(e){return console.error("Dashboard Data API Error:",e),d.NextResponse.json({error:e.message||"Falha ao carregar dashboard"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/dashboard/data/route",pathname:"/api/dashboard/data",filename:"route",bundlePath:"app/api/dashboard/data/route"},resolvedPagePath:"C:\\Users\\bruno\\Documents\\GitHub\\Divvy\\app\\api\\dashboard\\data\\route.ts",nextConfigOutput:"export",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:v,serverHooks:c}=l,m="/api/dashboard/data/route";function f(){return(0,o.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:v})}},78803:(e,r,t)=>{t.d(r,{m:()=>o});var a=t(37857);let i="https://jpgifiumxqzbroejhudc.supabase.co",s="sb_publishable_RWrlgQRxQHCQ45cEIia_ug_OT9ouCwi";if(!i)throw Error("Missing env NEXT_PUBLIC_SUPABASE_URL");if(!s)throw Error("Missing env NEXT_PUBLIC_SUPABASE_ANON_KEY");async function o(e){let r=e.headers.get("authorization")?.split(" ")[1];if(!r)throw Error("Unauthorized");let t=(0,a.eI)(i,s),{data:{user:o},error:d}=await t.auth.getUser(r);if(d||!o)throw Error("Unauthorized");return o}},30474:(e,r,t)=>{t.d(r,{f:()=>o});var a=t(37857);let i="https://jpgifiumxqzbroejhudc.supabase.co",s=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!i)throw Error("Missing env NEXT_PUBLIC_SUPABASE_URL");if(!s)throw Error("Missing env SUPABASE_SERVICE_ROLE_KEY");let o=()=>(0,a.eI)(i,s,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[9276,5972,7857],()=>t(37698));module.exports=a})();