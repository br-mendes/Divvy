"use strict";(()=>{var e={};e.id=6553,e.ids=[6553],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},22118:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{GET:()=>p});var a=r(49303),o=r(88716),i=r(60670),n=r(87070),u=r(30474),d=r(78803);async function p(e){try{let t=await (0,d.m)(e),r=(0,u.f)(),{data:s}=await r.from("userprofiles").select("is_super_admin").eq("id",t.id).single();if("falecomdivvy@gmail.com"!==t.email&&!s?.is_super_admin)return n.NextResponse.json({error:"Forbidden"},{status:403});let[{count:a},{count:o},{count:i},{count:p}]=await Promise.all([r.from("userprofiles").select("*",{count:"exact",head:!0}),r.from("divvies").select("*",{count:"exact",head:!0}),r.from("divvies").select("*",{count:"exact",head:!0}).eq("isarchived",!1),r.from("userprofiles").select("*",{count:"exact",head:!0}).lt("last_login_at",new Date(Date.now()-2592e6).toISOString())]);return n.NextResponse.json({totalUsers:a||0,inactive30Count:p||0,activeGroups:i||0,totalDivvies:o||0},{status:200})}catch(e){if(console.error("Stats API Error:",e),"Unauthorized"===e.message)return n.NextResponse.json({error:"Unauthorized: Invalid token"},{status:401});return n.NextResponse.json({error:e.message},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/stats/route",pathname:"/api/admin/stats",filename:"route",bundlePath:"app/api/admin/stats/route"},resolvedPagePath:"C:\\Users\\bruno\\Documents\\GitHub\\Divvy\\app\\api\\admin\\stats\\route.ts",nextConfigOutput:"export",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:m}=c,v="/api/admin/stats/route";function f(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},78803:(e,t,r)=>{r.d(t,{m:()=>i});var s=r(37857);let a="https://jpgifiumxqzbroejhudc.supabase.co",o="sb_publishable_RWrlgQRxQHCQ45cEIia_ug_OT9ouCwi";if(!a)throw Error("Missing env NEXT_PUBLIC_SUPABASE_URL");if(!o)throw Error("Missing env NEXT_PUBLIC_SUPABASE_ANON_KEY");async function i(e){let t=e.headers.get("authorization")?.split(" ")[1];if(!t)throw Error("Unauthorized");let r=(0,s.eI)(a,o),{data:{user:i},error:n}=await r.auth.getUser(t);if(n||!i)throw Error("Unauthorized");return i}},30474:(e,t,r)=>{r.d(t,{f:()=>i});var s=r(37857);let a="https://jpgifiumxqzbroejhudc.supabase.co",o=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!a)throw Error("Missing env NEXT_PUBLIC_SUPABASE_URL");if(!o)throw Error("Missing env SUPABASE_SERVICE_ROLE_KEY");let i=()=>(0,s.eI)(a,o,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,7857],()=>r(22118));module.exports=s})();