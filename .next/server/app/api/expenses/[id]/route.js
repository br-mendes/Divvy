"use strict";(()=>{var e={};e.id=7031,e.ids=[7031],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},19189:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>m,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>x});var r={};s.r(r),s.d(r,{DELETE:()=>d,PUT:()=>u});var a=s(49303),o=s(88716),i=s(60670),n=s(87070),p=s(30474);async function d(e,{params:t}){try{let e=t.id,s=(0,p.f)(),{data:r}=await s.from("expenses").select("locked").eq("id",e).single();if(r?.locked)return n.NextResponse.json({error:"Despesa bloqueada n\xe3o pode ser exclu\xedda."},{status:403});await s.from("expensesplits").delete().eq("expenseid",e);let{error:a}=await s.from("expenses").delete().eq("id",e);if(a)throw a;return n.NextResponse.json({success:!0},{status:200})}catch(e){return n.NextResponse.json({error:e.message},{status:500})}}async function u(e,{params:t}){try{let s=t.id,{divvyId:r,paidByUserId:a,amount:o,category:i,description:d,date:u,receiptPhotoUrl:c,splits:l}=await e.json(),x=(0,p.f)(),{data:f}=await x.from("expenses").select("locked").eq("id",s).single();if(f?.locked)return n.NextResponse.json({error:"Despesa bloqueada n\xe3o pode ser editada."},{status:403});let{error:m}=await x.from("expenses").update({divvyid:r,paidbyuserid:a,amount:o,category:i,description:d,date:u,receiptphotourl:c,updatedat:new Date().toISOString()}).eq("id",s);if(m)throw m;await x.from("expensesplits").delete().eq("expenseid",s);let h=l.map(e=>({expenseid:s,participantuserid:e.participantuserid,amountowed:e.amountowed})),{error:w}=await x.from("expensesplits").insert(h);if(w)throw w;return n.NextResponse.json({success:!0},{status:200})}catch(e){return n.NextResponse.json({error:e.message},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/expenses/[id]/route",pathname:"/api/expenses/[id]",filename:"route",bundlePath:"app/api/expenses/[id]/route"},resolvedPagePath:"C:\\Users\\bruno\\Documents\\GitHub\\Divvy\\app\\api\\expenses\\[id]\\route.ts",nextConfigOutput:"export",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:x,serverHooks:f}=c,m="/api/expenses/[id]/route";function h(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:x})}},30474:(e,t,s)=>{s.d(t,{f:()=>i});var r=s(37857);let a="https://jpgifiumxqzbroejhudc.supabase.co",o=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!a)throw Error("Missing env NEXT_PUBLIC_SUPABASE_URL");if(!o)throw Error("Missing env SUPABASE_SERVICE_ROLE_KEY");let i=()=>(0,r.eI)(a,o,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,5972,7857],()=>s(19189));module.exports=r})();